[FIELD]
Field(1).NAME = "Timestamp"
Field(1).TYPE = "DateTime"
Field(1).FORMAT = "yyyy-MM-dd"

Field(2).NAME = "Base"
Field(2).TYPE = "String"

Field(3).NAME = "CurrencyName"
Field(3).TYPE = "String"

Field(4).NAME = "CurrencyValue"
Field(4).TYPE = "number"

Field(5).Name = "TagName"
Field(5).Type = "String"

FIELD(6).Name = "DynAttrCol"
FIELD(6).Type = "Collection"

Field(7).NAME = "Value_NULL"
Field(7).TYPE = "Number"
'---------------------------------------------------------------------------

[MSG]
MSG(1).NAME = "Date"
MSG(2).Name = "BaseCurrency"
MSG(3).Name = "Currency"

'---------------------------------------------------------------------------

[Date]
Date.FILTER = C1=="*date*"
Timestamp = ["*date\": \"(*)\","]

'---------------------------------------------------------------------------

[BaseCurrency]
BaseCurrency.FILTER = C1=="*base*"
Base = ["*base\": \"(*)\""]
StoreElement(Base)

'---------------------------------------------------------------------------

[Currency]
Currency.FILTER = C1=="        *"

CurrencyName = ["*\"(*)\"*"]
TagName = Base + "_to_" + CurrencyName
CurrencyValue = ["*: (*),"]
' To deal with the last currency which does not have a trailing comma
IF CurrencyValue is Null THEN
	CurrencyValue = ["*: (*)"]
ENDIF

StoreEvent( TagName, CurrencyName, Timestamp, CurrencyValue )
DynAttrCol = Add(TagName)
StoreElement(Base, "Currency", DynAttrCol)